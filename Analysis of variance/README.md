# Дисперсионный анализ  
### Дисперсия – характеристика рассеивания данных вокруг их среднего значения.
 
## Дисперсионный анализ (ANOVA)  
статистическая процедура, используемая для сравнения средних значений определенной переменной в двух и более независимых группах.

## Общая сумма квадратов SST (общая изменчивость данных)      
показатель, характеризующий степень изменчивости данных без учета разделения их на группы. Вычисляется общая сумма квадратов следующим образом: 
+	для каждого наблюдения рассчитывается насколько оно отклонится от среднего значения,
+	складывается сумма квадратов полученных отклонений.
  

## Межгрупповая сумма квадратов SSB   
(характеристика, показывающая насколько групповые средние отклоняются от общего среднего) и внутригрупповая сумма квадратов SSW (сумма квадратов отклонений от среднего внутри каждой из групп).

## Внутригрупповая сумма квадратов SSW   
необъяснённая, характеризует рассеивание данных внутри градаций фактора (групп) вокруг средних значений этих групп.

## Межгрупповая дисперсия MSB  
объяснённая влиянием фактора, характеризует рассеивание значений между градациями (группами) вокруг средней всех данны.

## Внутригрупповая дисперсия MSW  
необъяснённая, характеризует рассеивание данных внутри градаций фактора (групп) вокруг средних значений этих групп.


## Отношение межгрупповой и внутригрупповой дисперсий  
фактическое отношение Фишера. Его сравнивают с критическим значением отношения Фишера.   

# Целью дисперсионного анализа  
является исследование наличия/отсутствия существенного влияния некоторого количественного/качественного фактора на изменения исследуемого признака.

### Пример  
Исследование зависимости прибыли предприятия от типа используемого сырья. В данном случае группы – типы сырья.

Минимальное число групп в дисперсионном анализе – две. Группы могут быть количественные и качественные.  
В дисперсионном анализе вычисляется удельный вес суммарного воздействия одного/нескольких факторов. Насколько влияние фактора существенно, исследуется с помощью гипотез:  
+	Нулевая гипотеза H0 утверждает, что все a классов градации имеют одинаковые значения средних: μ1 = μ2 = ... = μa 
+	Альтернативная гипотеза H1: не все классы градации имеют одно значение средних.


# **Однофакторный дисперсионный анализ**  
При формировании групп для сравнения в однофакторном дисперсионном анализе используется только одна переменная (фактор).   
### **Пример**  
Исследуется эффективность работы нового станка по обработке металлов с помощью дисперсионного анализа. Сравнение проводится с работой старого станка, который уже используется в производстве. В данном исследовании фактор – используемый станок. У него два уровня: новый, старый станки.   
В дисперсионном анализе фактор может иметь более двух уровней.  
##### Однофакторный дисперсионный анализ с двумя уровнями аналогичен t-критерию. Нулевая гипотеза обычно говорит о равенстве средних двух групп, альтернативная – о различии средних (двусторонний тест) или различии в определенном направлении (односторонний тест). 
Основные условия проведения дисперсионного анализа: 
1.	Зависимая переменная должна быть непрерывной, неограниченной/изменяющейся в широком интервале и представлена интервальными/характеризующими отношения данными; факторы должны быть дихотомическими/категориальными. 
2. Каждое значение зависимой переменной не должно зависеть от других ее значений. 
Исключения: рассматривается временная зависимость или значения были измерены у объектов, которые объединены в группы (члены одной семьи, учащиеся в одном классе) и это повлияло на зависимую переменную. 
3.	В каждой группе непрерывная переменная имеет приблизительно нормальное распределение. Нормальность распределения можно проверить, используя гистограмму («на глаз») или статистические тесты на нормальность.
4.	Дисперсии изучаемых групп должны быть приблизительно одинаковыми. Проверить похожесть дисперсий можно с помощью теста Левина, в котором нулевая гипотеза гласит, что дисперсия однородна, и если результат теста Левина статистически не значим (при применении критерия α < 0,05), то дисперсии достаточно похожи. 
Некоторые условия проведения дисперсионного анализа могут нарушаться, например, F-статистика надежна в случае, когда распределение непрерывной переменной отлично от нормального, а размеры групп одинаковы. Одинаковый размер обеспечивает и устойчивость F-статистики к нарушениям однородности дисперсии. А нарушение условия независимости может сильно исказить результаты. 
#### Однофакторный дисперсионный анализ  
основан на том, что общая сумма квадратов SST получена из двух компонент: межгрупповой суммы квадратов SSB и внутригрупповой суммы квадратов SSW:
SST= SSB + SSW
### **Пример**  
| Группа 1 | Группа 2 | Группа 3 |
|----------------|:---------:|----------------:|
|1|3|5|
|2|4|6|
|3|5|7|

Сравниваем 3 группы, в каждой из которых по 3 значения. 
Нулевая гипотеза: в генеральной совокупности нет значимых различий между средними, все средние трёх групп равны друг другу. Альтернативная гипотеза: хотя бы пара средних значимо различается между собой.

 $$ H_{0}: μ_{1}=μ_{2}=μ_{3} ТакЖе H_{1}: μ_{1} ≠μ_{2}=μ_{3} ИЛИ μ_1=μ_{2}≠μ_{3} ИЛИ μ_{1}≠μ_{2}≠μ_{3} $$ 
  
##### Вычислим среднее значение всех наблюдений:  

![Analysis of variance/picture_formuls/P1.PNG](https://github.com/Raccoonn78/4kursPython/blob/e8a8281f42e4afb2204bfe75eca9caabbb49acf9/Analysis%20of%20variance/picture_formuls/P1.PNG)  

##### Вычислим общую сумму квадратов:  
![Analysis of variance/picture_formuls/P2.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P2.PNG)  
##### Степени свободы для общей суммы квадратов:
$$  dF_{SST}=n-1=9-1=8  $$
##### Вычислим средние значения внутри каждой из групп: 
![Analysis of variance/picture_formuls/P3.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P3.PNG)  
##### Внутригрупповая сумма квадратов:
![Analysis of variance/picture_formuls/P4.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P4.PNG)  
##### Степени свободы для внутригрупповой суммы квадратов:
$$ dF_{SSW} =n-m=9-3=6 $$
##### Межгрупповая сумма квадратов:
![Analysis of variance/picture_formuls/P5.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P5.PNG)  
##### Степени свободы для межгрупповой суммы квадратов:
![Analysis of variance/picture_formuls/P6.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P6.PNG)  

##### Межгрупповая дисперсия:
![Analysis of variance/picture_formuls/P7.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P7.PNG)
##### Внутригрупповая дисперсия:
![Analysis of variance/picture_formuls/P8.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P8.PNG)
##### Вычислим F-значение:  
![Analysis of variance/picture_formuls/P9.PNG](https://github.com/Raccoonn78/4kursPython/blob/613e2e66c53648fd2b088b263d86b3f67141d14b/Analysis%20of%20variance/picture_formuls/P9.PNG)

Критическое значение отношения Фишера:  
$$ F_{0,05; 2;6} =5,14 $$
Так как фактическое отношение Фишера меньше критического:  
$$ F=12>5,14=F_{0,05; 2;6} $$
можно сделать вывод, что есть существенные различия между группами.   

